# 第五课

宏

- 声明宏
- 过程宏

Runtime == 线上的状态转移函数

- decl_storage 定义存储单元 
- decl_module 包含可调用函数 -》extrinsic 外部交易 
- decl_event 事件
- decl_error 错误信息
- construct_runtime 添加模块到 Runtime

decl_module 中的保留函数

- on_initialize，在每个区块的开头执行；
- on_finalize，在每个区块结束时执行；
- offchain_worker：开头且是链外执行，不占用链上的资源；
- on_runtime_upgrade：当有 runtime 升级时才会执行，用来迁移数据。

decl_error

- 不能给它们添加数据
- 通过metadata暴露给客户端 ？ 什么是metadata
- 错误发生时触发system.ExtrinsicFailed 事件，包含了对应错误的信息。

runtime_api  暴露runtime的函数给client

- 单值
    - 数值：u8,i8,u32,i32,u64,i64,u128,i128
    - 大整数：U128,U256,U512
    - 布尔：bool
    - 集合：Vec<T>, BTreeMap, BTreeSet
    - 定点小数：Percent,Permill,Perbill
    - 定长哈希：H128,H256,H512
    - 其它复杂类型：Option<T>,tuple,enum,struct
    - 内置自定义类型：Moment,AccountId
- 简单映射
- 双键映射